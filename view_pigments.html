<!DOCTYPE html>
<html>
<head>
  <title>View Pigment Records</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: url('plastics-map.png') no-repeat center center fixed; 
      background-size: cover;
      margin: 0;
    }

    .container {
      max-width: 1200px;
      margin: 50px auto;
      background-color: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }

    h1 { text-align: center; }

    .search-container {
      text-align: center;
      margin-top: 10px;
    }

    .search-container input {
      width: 400px;
      padding: 8px;
      margin: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
    }

    .search-container button {
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      background-color: #007BFF;
      color: white;
      cursor: pointer;
    }

    .search-container button:hover {
      background-color: #0056b3;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: white;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    th {
      background: #333;
      color: white;
    }

    tr:nth-child(even) { background: #f2f2f2; }

    .back-link {
      display: block;
      margin-top: 20px;
      text-align: center;
      text-decoration: none;
      font-weight: bold;
      color: #333;
    }

    .back-link:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <div class="container">
    <h1>View Pigment Records</h1>

    <div class="search-container">
      <input type="text" id="searchBox" placeholder="Search across selected columns...">
      <button onclick="filterTable()">Search</button>
    </div>

    <table id="pigmentTable">
      <thead></thead>
      <tbody></tbody>
    </table>

    <a href="index.html" class="back-link">â¬… Back to Dashboard</a>
  </div>

  <script>
    const viewURL = "https://script.google.com/macros/s/AKfycbwRc2XsIsa4MMGTHbMxqkR0gkyc-o__0ltB_-8GhpWs2dOi0O_FR3jICS6RiSAKvzUD/exec";

    let allRecords = [];
    let headers = [];

    // Columns you want to search by
    const searchColumns = ["PIGMENT NAME","COMMON NAME","CI NAME OF PIGMENT","COMPATIBLE POLYMERS","HEAT STABILITY","FOOD GRADE"];

    async function loadData() {
      try {
        const res = await fetch(viewURL);
        const data = await res.json();
        headers = data.headers;
        allRecords = data.records;
        renderTable(allRecords);
      } catch (err) {
        console.error("Error loading data:", err);
      }
    }

    function renderTable(records) {
      const thead = document.querySelector("#pigmentTable thead");
      const tbody = document.querySelector("#pigmentTable tbody");

      thead.innerHTML = "<tr>" + headers.map(h => `<th>${h}</th>`).join("") + "</tr>";

      tbody.innerHTML = records.map(r =>
        "<tr>" + headers.map(h => `<td>${r[h] || ""}</td>`).join("") + "</tr>"
      ).join("");
    }

    function filterTable() {
      const query = document.getElementById("searchBox").value.toUpperCase();

      const filtered = allRecords.filter(r => {
        return searchColumns.some(col => r[col] && r[col].toUpperCase().includes(query));
      });

      renderTable(filtered);
    }

    loadData();
  </script>
</body>
</html>
